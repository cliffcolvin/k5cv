<!DOCTYPE html>
{{- $defaultColor := .Site.Params.defaultColor | default "auto" -}}

{{/* allow website developer to enforce default dark mode */}}
{{- if eq $defaultColor "dark" -}}
<html lang="{{ .Site.LanguageCode }}" class="dark">
{{- else if eq $defaultColor "light" -}}
<html lang="{{ .Site.LanguageCode }}" class="light">
{{- else -}}
<html lang="{{ .Site.LanguageCode }}">
{{- end -}}

{{- partial "head.html" . -}}

<body data-theme="{{ $defaultColor }}" class="notransition">
    {{- partial "scriptsBodyStart.html" . -}}
    {{- partial "header.html" . -}}
    <div class="wrapper">
        {{ partial "bio" . }}
        <main aria-label="Content">
            <style>
                /* Override theme's narrow wrapper for homepage */
                .wrapper {
                    max-width: 90vw;
                    width: 100%;
                    padding: 0 2rem;
                }
                .categories-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                    gap: 2rem;
                    margin-bottom: 2rem;
                }
                .category-section {
                    min-width: 0;
                }
                .category-section .post-item {
                    margin-bottom: 0.5rem;
                }
                .category-section .posts-item-note {
                    margin-bottom: 1rem;
                    border-bottom: 1px solid var(--border);
                    padding-bottom: 0.5rem;
                }
                .more-posts-link {
                    margin-top: 0.5rem;
                    font-size: 0.9em;
                }
                @media (max-width: 768px) {
                    .wrapper {
                        padding: 0 1rem;
                    }
                    .categories-grid {
                        grid-template-columns: 1fr;
                    }
                }
            </style>
            <div class="categories-grid">
            {{/* Loop through each category under posts */}}
            {{ $postsSection := .Site.GetPage "section" "posts" }}
            {{ range $postsSection.Sections }}
                {{ $categoryPosts := .RegularPages.ByDate.Reverse }}
                {{ if gt (len $categoryPosts) 0 }}
                <section class="category-section">
                    <h3 class="posts-item-note">
                        <a href="{{ .Permalink }}" style="text-decoration: none; color: inherit;">{{ .Title }}</a>
                    </h3>
                    {{ range first 10 $categoryPosts }}
                    {{ partial "postCard" . }}
                    {{ end }}
                    {{ if gt (len $categoryPosts) 10 }}
                    <p class="more-posts-link">
                        <a href="{{ .Permalink }}">More {{ .Title }} posts â†’</a>
                    </p>
                    {{ end }}
                </section>
                {{ end }}
            {{ end }}
            </div>
            <br/>
            <iframe style="background-color: white;" align="top" frameborder="0" height="230" width="640" scrolling="no" src="https://ky4qx.com/pota_summary/k5cv"></iframe>
            <br/><br/>
            <iframe style="background-color: white;" align="top" frameborder="0" height="500" scrolling="yes" src="https://logbook.qrz.com/lbstat/K5CV/" width="640"></iframe>
        </main>
    </div>
    {{- partial "footer.html" . -}}
    {{- partial "scriptsBodyEnd.html" . -}}
</body>

</html>
